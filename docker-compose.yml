db:
  image: postgres:9.6.1-alpine
  environment:
    - POSTGRES_PASSWORD=mysecretpassword
    - POSTGRES_USER=ebicsbox
  expose:
    - "5432"
  volumes:
    - /tmp/data-postgresql:/var/lib/postgresql/data
queue:
  image: railslove/beanstalkd
  expose:
    - "11300"
  volumes:
    - /tmp/data-beanstalkd:/data
app:
  image: ebicsbox
  environment:
    - USERNAME=ebics
    - PASSWORD=istsuper
    - "BEANSTALKD_URL=queue:11300"
    - "DATABASE_URL=postgresql://db/ebicsbox?user=ebicsbox&password=mysecretpassword"
    - "PORT=5000"
    - "RACK_ENV=production"
    - "VIRTUAL_HOST=ebicsbox"
    - "PASSPHRASE=asdasdasdasdasd"
  links:
    - db
    - queue
  expose:
    - "5000"
  command: "bin/start all"
proxy:
  image: jwilder/nginx-proxy:latest
  volumes:
    - /var/run/docker.sock:/tmp/docker.sock:ro
  links:
    - "app:ebicsbox"
  ports:
    - "80:80"
    - "443:443"
